/** *	@service RequestWrite *	@desc Processes loadparams from url-encoded other formats * *	@param type string [message] optional default 'url' ('url', 'json') *	@param loadparams object [message|memory] optional default false * *	@return loadparams object [memory] *	@return contentType string [memory] ***/FireSpark.jquery.service.RequestWrite = {	run : function(message, memory){		if(message.loadparams || false){			var arg = message.loadparams;			if(memory.loadparams || false){				arg = arg + '&' + memory.loadparams;			}		}		else {			var arg = memory.loadparams || false;		}			var type = message.type || 'url';		var contentType =  'application/x-www-form-urlencoded';				if(arg !== false){			arg = arg.replace(/\+/g, '%20');			if(type != 'url'){				var params = arg.split('&');				var result = new Object();				for(var i=0, len=params.length; i<len; i++){					var prm = (params[i]).split('=');					result[prm[0]] = unescape(prm[1]);				}				arg = result;			}						switch(type){				case 'json' :					arg = JSON.stringify(arg);					contentType =  'application/json';					break;									case 'url' :				default :					break;			}		}				memory.loadparams = arg;		memory.contentType =  contentType;				return true;	}};